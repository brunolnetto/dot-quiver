graph TD
      1([1]) ==> CONFIG([CONFIG])
      CONFIG([CONFIG]) ==> TOKEN([TOKEN])
      TOKEN([TOKEN]) ==> TOKEN-RESPONSE{TOKEN-RESPONSE}
      TOKEN-RESPONSE{TOKEN-RESPONSE} ==> TOKEN-BAG([TOKEN-BAG])
      TOKEN-RESPONSE{TOKEN-RESPONSE} --> TOKEN-RESPONSE-END-ERROR([TOKEN-RESPONSE-END-ERROR])
      TOKEN-BAG([TOKEN-BAG]) ==> PROCESS([PROCESS])
      PROCESS([PROCESS]) ==> PROCESS-RESPONSE{PROCESS-RESPONSE}
      PROCESS-RESPONSE{PROCESS-RESPONSE} ==> PROCESS-ID-BAG([PROCESS-ID-BAG])
      PROCESS-RESPONSE{PROCESS-RESPONSE} --> PROCESS-RESPONSE-END-ERROR([PROCESS-RESPONSE-END-ERROR])
      PROCESS-ID-BAG([PROCESS-ID-BAG]) ==> CURRENT-STATE([CURRENT-STATE])
      CURRENT-STATE([CURRENT-STATE]) ==> CURRENT-STATE-RESPONSE{CURRENT-STATE-RESPONSE}
      CURRENT-STATE-RESPONSE{CURRENT-STATE-RESPONSE} ==> CURRENT-STATE-CHECK{CURRENT-STATE-CHECK}
      CURRENT-STATE-RESPONSE{CURRENT-STATE-RESPONSE} --> CURRENT-STATE-RESPONSE-END-ERROR([CURRENT-STATE-RESPONSE-END-ERROR])
      CURRENT-STATE-CHECK{CURRENT-STATE-CHECK} ==> CURRENT-STATE-EXPECTED{CURRENT-STATE-EXPECTED}
      CURRENT-STATE-CHECK{CURRENT-STATE-CHECK} --> CURRENT-STATE-CHECK-END-ERROR([CURRENT-STATE-CHECK-END-ERROR])
      CURRENT-STATE-CHECK{CURRENT-STATE-CHECK} --> NODE-EXPECTED{NODE-EXPECTED}
      CURRENT-STATE-CHECK{CURRENT-STATE-CHECK} --> CURRENT-STATE-WAIT[CURRENT-STATE-WAIT]
      CURRENT-STATE-EXPECTED{CURRENT-STATE-EXPECTED} ==> HISTORY([HISTORY])
      CURRENT-STATE-EXPECTED{CURRENT-STATE-EXPECTED} --> CURRENT-STATE-EXPECTED-END-ERROR([CURRENT-STATE-EXPECTED-END-ERROR])
      HISTORY([HISTORY]) ==> HISTORY-RESPONSE{HISTORY-RESPONSE}
      HISTORY-RESPONSE{HISTORY-RESPONSE} ==> HISTORY-BAG([HISTORY-BAG])
      HISTORY-RESPONSE{HISTORY-RESPONSE} --> HISTORY-RESPONSE-END-ERROR([HISTORY-RESPONSE-END-ERROR])
      HISTORY-BAG([HISTORY-BAG]) ==> HISTORY-EXPECTED{HISTORY-EXPECTED}
      HISTORY-EXPECTED{HISTORY-EXPECTED} --> HISTORY-EXPECTED-END-SUCCESS([HISTORY-EXPECTED-END-SUCCESS])
      HISTORY-EXPECTED{HISTORY-EXPECTED} ==> HISTORY-EXPECTED-END-ERROR([HISTORY-EXPECTED-END-ERROR])
      CURRENT-STATE-WAIT[CURRENT-STATE-WAIT] --> CURRENT-STATE([CURRENT-STATE])
      NODE-EXPECTED{NODE-EXPECTED} --> ACTIVITY-MANAGER[ACTIVITY-MANAGER]
      NODE-EXPECTED{NODE-EXPECTED} --> NODE-EXPECTED-END-ERROR([NODE-EXPECTED-END-ERROR])
      ACTIVITY-MANAGER[ACTIVITY-MANAGER] --> ACTIVITY-MANAGER-RESPONSE{ACTIVITY-MANAGER-RESPONSE}
      ACTIVITY-MANAGER-RESPONSE{ACTIVITY-MANAGER-RESPONSE} --> SUBMIT[SUBMIT]
      ACTIVITY-MANAGER-RESPONSE{ACTIVITY-MANAGER-RESPONSE} --> CURRENT-STATE-WAIT[CURRENT-STATE-WAIT]
      ACTIVITY-MANAGER-RESPONSE{ACTIVITY-MANAGER-RESPONSE} --> ACTIVITY-MANAGER-RESPONSE-END-ERROR([ACTIVITY-MANAGER-RESPONSE-END-ERROR])
      SUBMIT[SUBMIT] --> SUBMIT-RESPONSE{SUBMIT-RESPONSE}
      SUBMIT-RESPONSE{SUBMIT-RESPONSE} --> CURRENT-STATE([CURRENT-STATE])
      SUBMIT-RESPONSE{SUBMIT-RESPONSE} --> SUBMIT-RESPONSE-END-ERROR([SUBMIT-RESPONSE-END-ERROR])

      linkStyle 0 stroke:gold,stroke-width:4px
      linkStyle 1 stroke:gold,stroke-width:4px
      linkStyle 2 stroke:gold,stroke-width:4px
      linkStyle 3 stroke:gold,stroke-width:4px
      linkStyle 5 stroke:gold,stroke-width:4px
      linkStyle 6 stroke:gold,stroke-width:4px
      linkStyle 7 stroke:gold,stroke-width:4px
      linkStyle 9 stroke:gold,stroke-width:4px
      linkStyle 10 stroke:gold,stroke-width:4px
      linkStyle 11 stroke:gold,stroke-width:4px
      linkStyle 13 stroke:gold,stroke-width:4px
      linkStyle 17 stroke:gold,stroke-width:4px
      linkStyle 19 stroke:gold,stroke-width:4px
      linkStyle 20 stroke:gold,stroke-width:4px
      linkStyle 22 stroke:gold,stroke-width:4px
      linkStyle 24 stroke:gold,stroke-width:4px

      classDef default fill:#e0e0e0,stroke:#bdbdbd,stroke-width:3px
      classDef start_node fill:#3B1,stroke:#391,stroke-width:8px
      classDef finish_node fill:#3B1,stroke:#391,stroke-width:8px
      classDef trail_node fill:#0CF,stroke:#09F,stroke-width:6px
      classDef bugged_node fill:#F88,stroke:#F22,stroke-width:3px

      class 1 start_node
      class CONFIG trail_node
      class TOKEN trail_node
      class TOKEN-RESPONSE trail_node
      class TOKEN-BAG trail_node
      class TOKEN-RESPONSE-END-ERROR finish_node
      class PROCESS trail_node
      class PROCESS-RESPONSE trail_node
      class PROCESS-ID-BAG trail_node
      class PROCESS-RESPONSE-END-ERROR finish_node
      class CURRENT-STATE trail_node
      class CURRENT-STATE-RESPONSE trail_node
      class CURRENT-STATE-CHECK trail_node
      class CURRENT-STATE-RESPONSE-END-ERROR finish_node
      class CURRENT-STATE-EXPECTED trail_node
      class CURRENT-STATE-CHECK-END-ERROR finish_node
      class HISTORY trail_node
      class CURRENT-STATE-EXPECTED-END-ERROR finish_node
      class HISTORY-RESPONSE trail_node
      class HISTORY-BAG trail_node
      class HISTORY-RESPONSE-END-ERROR finish_node
      class HISTORY-EXPECTED trail_node
      class HISTORY-EXPECTED-END-SUCCESS finish_node
      class HISTORY-EXPECTED-END-ERROR finish_node
      class NODE-EXPECTED-END-ERROR finish_node
      class ACTIVITY-MANAGER-RESPONSE-END-ERROR finish_node
      class SUBMIT-RESPONSE-END-ERROR finish_node
